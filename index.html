<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#16151D" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Mayyal Mayyal" />
  <meta name="description" content="Mayyal Mayyal - Fast Food" />
  <title>Mayyal Mayyal</title>
  
  <!-- Cache Control -->
  <meta http-equiv="Cache-Control" content="public, max-age=31536000">
  <meta http-equiv="Expires" content="31536000">
  
  <!-- Preload critical assets -->
  <link rel="preload" href="assets/bg.webp" as="image">
  <link rel="preload" href="assets/logo.webp" as="image">
  <link rel="preload" href="assets/hawawshi.webp" as="image">
  <link rel="preload" href="assets/kofta.webp" as="image">
  <link rel="preload" href="assets/tawouk.webp" as="image">
  <link rel="preload" href="assets/ig_black.svg" as="image">
  <link rel="preload" href="assets/loc.webp" as="image">
  <link rel="preload" href="style.css" as="style">
  
  <link rel="stylesheet" href="style.css" />
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://www.instagram.com">
  <link rel="preconnect" href="https://maps.app.goo.gl">
</head>
<body>
  <div id="loading-screen">
    <img src="assets/eighties.webp" alt="Eighties Flash" />
  </div>
  
  <div id="main-content">
    <div class="hero">
      <header>
        <img src="assets/logo.webp" alt="Mayyal Logo" class="logo" />
      </header>

      <div class="sandwich-switcher">
        <img src="assets/hawawshi.webp" alt="Hawawshi" class="sandwich active" />
        <img src="assets/kofta.webp" alt="Kofta" class="sandwich" />
        <img src="assets/tawouk.webp" alt="Tawouk" class="sandwich" />
      </div>

      <div class="social-bar">
        <a href="https://www.instagram.com/mayyal.eg" target="_blank" class="social-icon">
          <img src="assets/ig_black.svg" alt="Instagram" />
        </a>
        <a href="https://maps.app.goo.gl/HSQ31WB5SM9rLsvi7" target="_blank" class="social-icon">
          <img src="assets/loc.webp" alt="Location" />
        </a>
      </div>

      <a href="https://www.mayyalmayyal.com/table?franchise=B01&isFranchiseSelected=true" class="cta-button">
        ORDER NOW
      </a>
    </div>
  </div>
  <script>
    // Register Service Worker for offline caching
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then(registration => {
            console.log('ServiceWorker registration successful');
          })
          .catch(err => {
            console.log('ServiceWorker registration failed: ', err);
          });
      });
    }

    // Function to preload images with error handling and responsive loading
    const preloadImages = (images) => {
      return Promise.all(images.map(img => {
        return new Promise((resolve, reject) => {
          const image = new Image();
          
          // Add error handling
          image.onerror = () => {
            console.error(`Failed to load image: ${img}`);
            // Show fallback image or placeholder
            const element = document.querySelector(`img[src="${img}"]`);
            if (element) {
              element.classList.add('image-error');
              element.alt = 'Image failed to load';
            }
            resolve(); // Resolve anyway to continue loading other images
          };

          image.onload = () => {
            const element = document.querySelector(`img[src="${img}"]`);
            if (element) {
              element.classList.add('loaded');
            }
            resolve();
          };

          image.src = img;
        });
      }));
    };

    // List of all images to preload
    const imagesToPreload = [
      'assets/bg.webp',
      'assets/logo.webp',
      'assets/hawawshi.webp',
      'assets/kofta.webp',
      'assets/tawouk.webp',
      'assets/ig_black.svg',
      'assets/loc.webp'
    ];

    // Show loading screen immediately
    document.addEventListener('DOMContentLoaded', () => {
      const loadingScreen = document.getElementById('loading-screen');
      const mainContent = document.getElementById('main-content');
      
      // Show loading screen
      loadingScreen.style.opacity = '1';
      mainContent.style.opacity = '0';
      
      // Preload all images
      preloadImages(imagesToPreload)
        .then(() => {
          // All images loaded successfully
          setTimeout(() => {
            // Fade out loading screen
            loadingScreen.style.opacity = '0';
            
            // Show main content after a short delay
            setTimeout(() => {
              loadingScreen.style.display = 'none';
              mainContent.style.opacity = '1';
            }, 1000);
          }, 2000);
        })
        .catch(error => {
          console.error('Error loading images:', error);
          // Even if there's an error, show the content after a delay
          setTimeout(() => {
            loadingScreen.style.display = 'none';
            mainContent.style.opacity = '1';
          }, 2000);
        });
    });
  </script>
</body>
</html>
